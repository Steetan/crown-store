{"version":3,"file":"static/js/238.fb6ed335.chunk.js","mappings":"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","sources":["pages/Registration.tsx"],"sourcesContent":["import React from 'react'\r\nimport { useForm } from 'react-hook-form'\r\nimport { RootState, useAppDispatch } from '../redux/store'\r\nimport { fetchRegister, selectIsAuth, setUserImgUrl } from '../redux/slices/authSlice'\r\nimport { useSelector } from 'react-redux'\r\nimport { Link, Navigate } from 'react-router-dom'\r\nimport { TextField } from '@mui/material'\r\nimport customAxios from '../axios'\r\nimport axios from 'axios'\r\n\r\nexport interface FormData {\r\n\tname: string\r\n\tfname: string\r\n\toname: string\r\n\temail: string\r\n\tphone: number\r\n\tpassword: string\r\n\tconfirmPassword: string\r\n\turl?: string\r\n}\r\n\r\nconst Registration = ({}) => {\r\n\tconst dispatch = useAppDispatch()\r\n\tconst isAuth = useSelector(selectIsAuth)\r\n\tconst { userImgUrl } = useSelector((state: RootState) => state.authSlice)\r\n\r\n\tconst inputFileRef = React.useRef<HTMLInputElement>(null)\r\n\r\n\tconst {\r\n\t\tregister,\r\n\t\thandleSubmit,\r\n\t\tformState: { errors },\r\n\t} = useForm<FormData>()\r\n\r\n\tconst onSubmit = async (values: FormData) => {\r\n\t\tconst data = await dispatch(fetchRegister({ ...values, url: userImgUrl }))\r\n\r\n\t\tif (!data.payload) {\r\n\t\t\treturn alert('Не удалось зарегистрироваться!')\r\n\t\t}\r\n\r\n\t\tif (data.payload.token) {\r\n\t\t\twindow.localStorage.setItem('token', data.payload.token)\r\n\t\t}\r\n\t}\r\n\r\n\tif (isAuth) {\r\n\t\treturn <Navigate to='/' />\r\n\t}\r\n\r\n\tconst handleFileChange = async (event: any) => {\r\n\t\ttry {\r\n\t\t\tconst formData = new FormData()\r\n\t\t\tformData.append('image', event.target.files[0])\r\n\r\n\t\t\tcustomAxios.post('http://localhost:8080/upload/user', formData).then(({ data }) => {\r\n\t\t\t\tdispatch(setUserImgUrl(`${data.url}`))\r\n\t\t\t})\r\n\t\t} catch (error) {\r\n\t\t\tconsole.warn(error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst deleteImg = () => {\r\n\t\ttry {\r\n\t\t\taxios.delete(`http://localhost:8080/upload/auth/delete/${userImgUrl}`)\r\n\t\t\tif (inputFileRef.current) {\r\n\t\t\t\tinputFileRef.current.value = ''\r\n\t\t\t}\r\n\t\t\tdispatch(setUserImgUrl(''))\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='form-block-wrapper'>\r\n\t\t\t<div className='form-block'>\r\n\t\t\t\t<h3 className='form-block__title'>Регистрация</h3>\r\n\t\t\t\t<form onSubmit={handleSubmit(onSubmit)}>\r\n\t\t\t\t\t<div className='form-block__inputs'>\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tlabel='Имя'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('name', { required: 'Укажите имя' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.name && <p style={{ color: 'red' }}>{errors.name.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Фамилия'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('fname', { required: 'Укажите фамилию' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.fname && <p style={{ color: 'red' }}>{errors.fname.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Отчество'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('oname', { required: 'Укажите отчество' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.oname && <p style={{ color: 'red' }}>{errors.oname.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Email'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('email', { required: 'Укажите почту' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.email && <p style={{ color: 'red' }}>{errors.email.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Номер телефона'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('phone', { required: 'Укажите номер телефона' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.phone && <p style={{ color: 'red' }}>{errors.phone.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Пароль'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\t\t{...register('password', { required: 'Укажите пароль' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.password && <p style={{ color: 'red' }}>{errors.password.message}</p>}\r\n\t\t\t\t\t\t{!userImgUrl && (\r\n\t\t\t\t\t\t\t<label htmlFor='file-upload' className='custom-file-upload'>\r\n\t\t\t\t\t\t\t\tЗагрузить фото\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tid='file-upload'\r\n\t\t\t\t\t\t\tref={inputFileRef}\r\n\t\t\t\t\t\t\ttype='file'\r\n\t\t\t\t\t\t\tstyle={{ display: 'none' }}\r\n\t\t\t\t\t\t\tonChange={handleFileChange}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t{userImgUrl && (\r\n\t\t\t\t\t\t\t<button className='settings__btn-delete' onClick={deleteImg}>\r\n\t\t\t\t\t\t\t\tУдалить\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tclassName='form-block__img-upload'\r\n\t\t\t\t\t\t\tsrc={`http://localhost:8080/uploads/userIcons/${userImgUrl}`}\r\n\t\t\t\t\t\t\talt=''\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='form-block__btns'>\r\n\t\t\t\t\t\t<button type='submit' className='button button--footer'>\r\n\t\t\t\t\t\t\tЗарегистрироваться\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\tЕсть аккаунт?\r\n\t\t\t\t\t\t\t<Link to='/auth/login' className='button-link-reg'>\r\n\t\t\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\t\t\tВойти\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Registration\r\n"],"names":["_ref","dispatch","useAppDispatch","isAuth","useSelector","selectIsAuth","userImgUrl","state","authSlice","inputFileRef","React","register","handleSubmit","formState","errors","useForm","_jsx","Navigate","to","className","children","_jsxs","onSubmit","async","data","fetchRegister","values","url","payload","alert","token","window","localStorage","setItem","TextField","error","password","id","label","variant","required","name","style","color","message","fname","oname","email","phone","type","htmlFor","ref","display","onChange","formData","FormData","append","event","target","files","customAxios","post","then","_ref2","setUserImgUrl","concat","console","warn","onClick","deleteImg","axios","delete","current","value","log","src","alt","Link"],"sourceRoot":""}