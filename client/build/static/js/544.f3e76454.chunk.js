"use strict";(self.webpackChunkcrown_store=self.webpackChunkcrown_store||[]).push([[544],{6544:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var a=s(2791),l=s(4032),n=s(5027),i=s(5038),c=s(7689),o=s(1087),r=s(4420),d=s(184);const u=e=>{let{}=e;const[t,s]=a.useState(""),[u,m]=a.useState(""),[h,p]=a.useState(""),[g,_]=a.useState(""),[x,j]=a.useState(!1),w=a.useRef(null),{userImgUrl:b}=(0,r.v9)((e=>e.authSlice)),[N,v]=a.useState(""),[f,y]=a.useState(""),k=(0,n.T)(),C=(0,c.s0)();a.useEffect((()=>{(async()=>{const{data:e}=await l.Z.get("auth/meinfo");s(e.name_user),m(e.fname_user),p(e.oname_user),_(e.email),j(e.access)})()}),[]);return(0,d.jsxs)("div",{className:"settings",children:[(0,d.jsx)("h2",{className:"settings__title",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"}),(0,d.jsxs)("div",{className:"settings__main-block",children:[(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"form-block",children:[(0,d.jsx)("h3",{className:"form-block__title",children:"\u041f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435"}),(0,d.jsx)("h4",{className:"settings__label",children:"\u0418\u043c\u044f"}),(0,d.jsx)("input",{className:"settings__input",type:"text",value:t,onChange:e=>s(e.target.value)}),!t&&(0,d.jsx)("p",{style:{color:"red",marginBottom:10},children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f"}),(0,d.jsx)("h4",{className:"settings__label",children:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f"}),(0,d.jsx)("input",{className:"settings__input",type:"text",value:u,onChange:e=>m(e.target.value)}),!u&&(0,d.jsx)("p",{style:{color:"red",marginBottom:10},children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0430\u043c\u0438\u043b\u0438\u044e"}),(0,d.jsx)("h4",{className:"settings__label",children:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e"}),(0,d.jsx)("input",{className:"settings__input",type:"text",value:h,onChange:e=>p(e.target.value)}),!h&&(0,d.jsx)("p",{style:{color:"red",marginBottom:10},children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043e\u0442\u0447\u0435\u0441\u0442\u0432\u043e"}),(0,d.jsx)("h4",{className:"settings__label",children:"Email"}),(0,d.jsx)("input",{className:"settings__input",type:"text",value:g,onChange:e=>_(e.target.value)}),!h&&(0,d.jsx)("p",{style:{color:"red",marginBottom:10},children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 email"}),(0,d.jsx)("button",{type:"submit",className:"button button--footer",onClick:async()=>{try{if(t&&u){const{data:e}=await l.Z.patch("/auth/update",{name:t,fname:u,oname:h,email:g});alert(e.message),localStorage.removeItem("token"),C("/"),window.location.reload()}}catch(e){console.log(e),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435")}},children:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"})]})}),(0,d.jsxs)("div",{className:"settings__block-right",children:[(0,d.jsxs)("div",{className:"settings__password-block",children:[(0,d.jsx)("h3",{className:"form-block__title settings__password-title",children:"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"}),(0,d.jsxs)("div",{className:"settings__password-inputs",children:[(0,d.jsx)("div",{className:"settings__password-input",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"settings__label",children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),(0,d.jsx)("input",{className:"settings__input",type:"password",value:N,onChange:e=>v(e.target.value)})]})}),(0,d.jsx)("div",{className:"settings__password-hr"}),(0,d.jsx)("div",{className:"settings__password-input",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"settings__label",children:"\u041f\u0430\u0440\u043e\u043b\u044c \u0435\u0449\u0451 \u0440\u0430\u0437"}),(0,d.jsx)("input",{className:"settings__input",type:"password",value:f,onChange:e=>y(e.target.value)})]})})]}),N!==f&&(0,d.jsx)("p",{style:{color:"red",marginBottom:10,textAlign:"center"},children:"\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"}),(0,d.jsx)("div",{className:"settings__btn-password-block",children:(0,d.jsx)("button",{className:"button button--footer settings__btn-password-update",onClick:async()=>{try{if(N&&N===f){const{data:e}=await l.Z.patch("/auth/updpass",{password:N});e&&alert("\u041f\u0430\u0440\u043e\u043b\u044c \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d")}}catch(e){console.log(e),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c")}},children:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})})]}),!b&&(0,d.jsx)("label",{htmlFor:"file-upload",className:"custom-file-upload",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u043e\u0442\u043e"}),(0,d.jsx)("input",{id:"file-upload",ref:w,type:"file",style:{display:"none"},onChange:async e=>{try{const t=new FormData;t.append("image",e.target.files[0]),await l.Z.post("http://localhost:8080/upload/user",t).then((e=>{let{data:t}=e;try{k((0,i.mf)("".concat(t.url))),l.Z.patch("/auth/updimg",{img:t.url}).then((e=>{let{data:t}=e;t&&alert("\u0410\u0432\u0430\u0442\u0430\u0440\u043a\u0430 \u0431\u044b\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0430")}))}catch(s){console.log(s),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0443")}}))}catch(t){console.warn(t)}}}),b&&(0,d.jsx)("button",{className:"settings__btn-delete",onClick:async()=>{if(window.confirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?")){try{await l.Z.delete("http://localhost:8080/upload/user/delete/".concat(b)),w.current&&(w.current.value=""),await l.Z.patch("/auth/updimg",{img:""})}catch(e){console.log(e)}k((0,i.mf)(""))}},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}),(0,d.jsx)("img",{className:"form-block__img-upload",src:"http://localhost:8080/uploads/userIcons/".concat(b),alt:""})]})]}),(0,d.jsx)("button",{className:"settings__btn-delete settings__btn-delete--acc",onClick:async()=>{window.confirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?")&&!x&&(await l.Z.delete("/cart/deleteallbyid"),await k((0,i.qA)(window.localStorage.getItem("token"))).finally((()=>{window.localStorage.removeItem("token"),C("/")})),window.location.reload())},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442"}),(0,d.jsx)(o.rU,{to:"/",className:"button button--black",style:{marginTop:20},children:(0,d.jsx)("span",{children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043d\u0430\u0437\u0430\u0434"})})]})}}}]);
//# sourceMappingURL=544.f3e76454.chunk.js.map